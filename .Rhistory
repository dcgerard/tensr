##Generate data with above covariance structure.
X <- atrans(array(rnorm(prod(p)), dim = p), lapply(cov_list, mhalf))
devtools::document()
devtools::install()
library(tensr)
holq_x <- holq(X, print_diff = FALSE)
mle_x <- mle_from_holq(holq_x)
cov_mle <- mle_x$cov_mle
#The "standard deviation" form for the total variation parameter.
sig_mle <- mle_x$sig_mle
sig_mle
cov_mle
devtools::check()
library(devtools)
document
document()
install()
check()
library(lintr)
lint("R")
lint("R/equi_mcmc.R")
n <- 10
Phi <- matrix(rnorm(n^2),nrow = n)
Phi
Phi <- Phi %*% t(Phi)
chol(Phi[,ncol(Phi):1])[,ncol(Phi):1]
lint("R/equi_mcmc.R")
lint("R/basic_tensor.R")
install()
document()
install()
check()
.libPaths()
cd
ls
cd ..
ls
library(tensr)
.libPaths()
tensr
library(tensr)
ls
equi_mcmc
?equi_mcmc
browseVignettes()
devtools::build(binary = TRUE)
?devtools::build
library(help = "devtools")
?devtools
package?devtools
devtools::build_vignettes()
devtools::build(binary = TRUE)
devtools::document()
devtools::install()
library(tensr)
browseVignettes()
devtools::check()
devtools::use_vignette("maximum_likelihood")
p <- c(5, 5, 5, 5)
X <- array(rnorm(prod(p)),dim = p)
cov_Y <- list()
cov_Y <- start_ident(p)
cov_Y
abs(outer(1:p[4],1:p[4],"-"))
cov_Y[[4]] <- 0.9^abs(outer(1:p[4],1:p[4],"-"))
cov_Y
cov_Z <- start_ident(p)
cov_Y <- start_ident(p)
cov_Y[[4]] <- 0.9^abs(outer(1:p[4],1:p[4],"-"))
Y <- atrans(array(rnorm(prod(p)),dim = p), lapply(cov_Y, mhalf))
Y
Z <- atrans(array(rnorm(prod(p)),dim = p), lapply(cov_Z, mhalf))
Z
Y
holq_Z <- holq(Z,mode_rep = 4, mode_diag = c(1,2))
Z
holq_Z
diag(mat(Z,1) %*% t(mat(Z,1)))
1:p[1]
holq_X <- holq(Z,mode_rep = 1:4)
holq_X
holq_Y <- holq(Y,mode_rep = 1:3)
mle_X <- mle_from_holq(holq_X)
mle_X
cov_Y[[4]] <- cov_Y[[4]] / det(cov_Y[[4]])^(1/p[4])
det(cov_Y[[4]])
p <- c(5, 5, 5, 5)
X <- array(rnorm(prod(p)),dim = p)
cov_Y <- start_ident(p)
cov_Y[[4]] <- 0.9^abs(outer(1:p[4],1:p[4],"-"))
cov_Y[[4]] <- cov_Y[[4]] / det(cov_Y[[4]])^(1/p[4]) #scale to have unit determinant.
Y <- atrans(array(rnorm(prod(p)),dim = p), lapply(cov_Y, mhalf))
cov_Z <- start_ident(p)
diag(cov_Z[[1]]) <- 1:p[1] / prod(1:p[1])^(1/p[1])
diag(cov_Z[[2]]) <- p[2]:1 / prod(1:p[2])^(1/p[2])
cov_Z[[3]] <- 0.9^abs(outer(1:p[3],1:p[3],"-"))
cov_Z[[3]] <- cov_Z[[3]] / det(cov_Z[[3]])^(1/p[3])
Z <- atrans(array(rnorm(prod(p)),dim = p), lapply(cov_Z, mhalf))
lapply(cov_Z, det)
lapply(cov_Y, det)
p <- c(10, 10, 10, 10)
X <- array(rnorm(prod(p)),dim = p)
cov_Y <- start_ident(p)
cov_Y[[4]] <- 0.9^abs(outer(1:p[4],1:p[4],"-"))
cov_Y[[4]] <- cov_Y[[4]] / det(cov_Y[[4]])^(1/p[4]) #scale to have unit determinant.
Y <- atrans(array(rnorm(prod(p)),dim = p), lapply(cov_Y, mhalf))
cov_Z <- start_ident(p)
diag(cov_Z[[1]]) <- 1:p[1] / prod(1:p[1])^(1/p[1])
diag(cov_Z[[2]]) <- p[2]:1 / prod(1:p[2])^(1/p[2])
cov_Z[[3]] <- 0.9^abs(outer(1:p[3],1:p[3],"-"))
cov_Z[[3]] <- cov_Z[[3]] / det(cov_Z[[3]])^(1/p[3])
Z <- atrans(array(rnorm(prod(p)),dim = p), lapply(cov_Z, mhalf))
holq_X <- holq(X,mode_rep = 1:4)
holq_Y <- holq(Y,mode_rep = 1:3)
holq_Z <- holq(Z,mode_rep = 4, mode_diag = c(1,2))
mle_X <- mle_from_holq(holq_X)
mle_X
mle_Y <- mle_from_holq(holq_Y)
mle_Y
mle_Z <- mle_from_holq(holq_Z)
mle_Z
cat("Esttimates of scale:\n",
"From X:", mle_X$sig_mle
"From Y:", mle_Y$sig_mle
"From Z:", mle_Z$sig_mle
)
cat("Esttimates of scale:\n",
"From X:", mle_X$sig_mle,"\n",
"From Y:", mle_Y$sig_mle,"\n",
"From Z:", mle_Z$sig_mle,"\n"
)
diag(cov_Z[[1]])
diag(mle_Z[[1]][[1]])
cat("True:", paste("(",paste(diag(cov_Z[[1]]),collapse = ","),")",sep = ""),"\n",
"Estimate:", paste("(",paste(diag(mle_Z[[1]][[1]]),collapse = ","),")",sep = ""),"\n")
cat("True:", paste("(", paste(round(diag(cov_Z[[1]]), digits = 2), collapse = ","), ")",sep = ""), "\n",
"Estimate:", paste("(", paste(round(diag(mle_Z[[1]][[1]]), digits = 2), collapse = ","), ")", sep = ""), "\n")
cat("    True:", paste("(", paste(round(diag(cov_Z[[1]]), digits = 2), collapse = ","), ")",sep = ""), "\n",
"Estimate:", paste("(", paste(round(diag(mle_Z[[1]][[1]]), digits = 2), collapse = ","), ")", sep = ""), "\n")
cat("     True:", paste("(", paste(round(diag(cov_Z[[1]]), digits = 2), collapse = ","), ")",sep = ""), "\n",
"Estimate:", paste("(", paste(round(diag(mle_Z[[1]][[1]]), digits = 2), collapse = ","), ")", sep = ""), "\n")
cat("     True:", paste("(", paste(round(diag(cov_Z[[1]]), digits = 2), collapse = ", "), ")",sep = ""), "\n",
"Estimate:", paste("(", paste(round(diag(mle_Z[[1]][[1]]), digits = 2), collapse = ","), ")", sep = ""), "\n")
cat("     True:", paste("(", paste(round(diag(cov_Z[[1]]), digits = 2), collapse = ", "), ")",sep = ""), "\n",
"Estimate:", paste("(", paste(round(diag(mle_Z[[1]][[1]]), digits = 2), collapse = ", "), ")", sep = ""), "\n")
cat("     True:", paste("(", paste(format(diag(cov_Z[[1]]), digits = 2), collapse = ", "), ")",sep = ""), "\n",
"Estimate:", paste("(", paste(format(diag(mle_Z[[1]][[1]]), digits = 2), collapse = ", "), ")", sep = ""), "\n")
null_distribution <- lrt_null_dist_dim_same(p = p,null_ident = 1:4,alt_ident = 1:3)
null_distribution <- lrt_null_dist_dim_same(p = p,null_ident = 1:4,alt_ident = 1:3)
sig_k <- holq(X,mode_rep = 1:3, print_diff = FALSE)$sig
sig_h <- holq(X,mode_rep = 1:4, print_diff = FALSE)$sig
lrt_stat_val_X <- lrt_stat(sig_null = sig_h,sig_alt = sig_k,p = p)
sig_k <- holq(Y,mode_rep = 1:3, print_diff = FALSE)$sig
sig_h <- holq(Y,mode_rep = 1:4, print_diff = FALSE)$sig
lrt_stat_val_Y <- lrt_stat(sig_null = sig_h,sig_alt = sig_k,p = p)
p_value_x <- mean(null_distribution > lrt_stat_val_X)
p_value_y <- mean(null_distribution > lrt_stat_val_Y)
p_value_x
p_valu_y
p_value_y
null_distribution <- lrt_null_dist_dim_same(p = p,null_ident = 1:4,alt_ident = 1:3, itermax = 1000)
sig_k <- holq(X,mode_rep = 1:3, print_diff = FALSE)$sig
sig_h <- holq(X,mode_rep = 1:4, print_diff = FALSE)$sig
lrt_stat_val_X <- lrt_stat(sig_null = sig_h,sig_alt = sig_k,p = p)
sig_k <- holq(Y,mode_rep = 1:3, print_diff = FALSE)$sig
sig_h <- holq(Y,mode_rep = 1:4, print_diff = FALSE)$sig
lrt_stat_val_Y <- lrt_stat(sig_null = sig_h,sig_alt = sig_k,p = p)
p_value_x <- mean(null_distribution > lrt_stat_val_X)
p_value_y <- mean(null_distribution > lrt_stat_val_Y)
p_value_x
p_value_y
cat("p-value using X:", p_value_x,"\n",
"p-value using Y:", p_vlaue_y,"\n")
p_value_y <- mean(null_distribution > lrt_stat_val_Y)
cat("p-value using X:", p_value_x,"\n",
"p-value using Y:", p_value_y,"\n")
cat(" p-value using X:", p_value_x,"\n",
"p-value using Y:", p_value_y,"\n")
hist(null_distribution,xlab = "LRT Stat",main = "Null Distribution")
abline(v = lrt_stat_val_x,col = 2,lwd = 2,lty = 2)
abline(v = lrt_stat_val_y,col = 4,lwd = 2,lty = 2)
hist(null_distribution,xlab = "LRT Stat",main = "Null Distribution")
abline(v = lrt_stat_val_X,col = 2,lwd = 2,lty = 2)
abline(v = lrt_stat_val_Y,col = 4,lwd = 2,lty = 2)
abline(v = lrt_stat_val_Y,col = 4,lwd = 2,lty = 2)
lrt_stat_val_Y
legend("topright", c("From X","From Y"), col = c(2,4), lty = 2, lwd = 2)
null_distribution <- lrt_null_dist_dim_same(p = p,null_ident = 4,alt_ident = 4, null_diag = 1, alt_diag = c(1,2), itermax = 500)
sig_k <- holq(Z,mode_rep = 4, mode_diag = c(1,2), print_diff = FALSE)$sig
sig_h <- holq(Z,mode_rep = c(2,4), mode_diag = 1, print_diff = FALSE)$sig
lrt_stat_val_Z <- lrt_stat(sig_null = sig_h,sig_alt = sig_k,p = p)
p_value_z <- mean(null_distribution > lrt_stat_val_Z)
cat(" p-value using X:", p_value_x,"\n",
"p-value using Y:", p_value_y,"\n")
cat(" p-value:", p_value_x,"\n")
par(mar = c(2.5,2.5,2,0), mgp = c(1.5,.5,0))
hist(null_distribution,xlab = "LRT Stat",main = "Null Distribution")
abline(v = lrt_stat_val_Z,col = 2,lwd = 2,lty = 2)
legend("topright", c("From X","From Y"), col = c(2,4), lty = 2, lwd = 2, cex = 0.6)
legend("topright", "True LRT", col = 2, lty = 2, lwd = 2, cex = 0.6)
par(mar = c(2.5,2.5,2,0), mgp = c(1.5,.5,0))
hist(null_distribution,xlab = "LRT Stat",main = "Null Distribution")
abline(v = lrt_stat_val_Z,col = 2,lwd = 2,lty = 2)
legend("topright", "True LRT", col = 2, lty = 2, lwd = 2, cex = 0.6)
cat(" p-value:", p_value_x,"\n")
cat(" p-value:", p_value_z,"\n")
devtools::build_vignettes()
devtools::build(binary = TRUE)
devtools::document()
devtools::install()
library(tensor)
browseVignettes()
package?tensr
?tensr
package?tensr
?tensr
package?tensr
?tensr
package?tensr
?tensr
X <- c(0, 1, 10^-7, -1, -10^-7)
X
trim(X)
devtools::build(binary = TRUE)
devtools::build()
devtools::install()
library(tensr)
browseVignettes()
?"tensr"
lq
library(tensr)
?tensr
browseVignettes()
?equi_mcmc
library(tensr)
?equi_mcmc
library(tensr)
?tensr
?tensr
library(tensr)
?tensr
?equi_mcmc
?tensr
mle_from_holq
?holq
?isvd
?get_isvd
library(devtools)
document()
?zscores
document()
?hooi
lintr::lint()
lintr::lint_package()
lintr::lint_package()
lintr::lint_package()
lintr::lint_package()
lintr::lint_package()
document()
document()
?Kom
check()
?anorm_cd
m<-c(6,5,4)
K<-length(m)
M<-rsan(m)
S<-list() ; for(k in 1:K) { S[[k]]<-rwish(diag(m[k]))/m[k] }
Y<-M+atrans(rsan(m),lapply(S,mhalf))
SY<-Y*0
SS<-list() ; for(k in 1:K) { SS[[k]]<-matrix(0,m[k],m[k]) }
for(s in 1:1e4)
{
saidx<-list()
for(k in 1:K){ saidx[[k]]<-sort(sample(1:m[k],1+rbinom(1,m[k]-1,.5))) }
MS<-anorm_cd(Y,M,S,saidx)
Ya<- MS$Mab + atrans(rsan(sapply(saidx,length)),lapply(MS$Sab,mhalf))
Y[arrIndices(saidx)]<-Ya
SY<-SY+Y
for(k in 1:K){SS[[k]]<-SS[[k]]+mat(Y-M,k)%*%t(mat(Y-M,k)) }
}
par(mfrow=c(2,2))
plot(M,SY/s)  ; abline(0,1)
for (k in 1:K) {plot(S[[k]]/tr(S[[k]]),SS[[k]]/tr(SS[[k]])) ; abline(0,1) }
SY<-Y*0
SS<-list() ; for(k in 1:K) { SS[[k]]<-matrix(0,m[k],m[k]) }
for(s in 1:1e4)
{
saidx<-list()
for(k in 1:K){ saidx[[k]]<-sort(sample(1:m[k],1+rbinom(1,m[k]-1,.5))) }
MS<-anorm_cd(Y,M,S,saidx)
Ya<- MS$Mab + atrans(rsan(sapply(saidx,length)),lapply(MS$Sab,mhalf))
Y[arrIndices(saidx)]<-Ya
SY<-SY+Y
for(k in 1:K){SS[[k]]<-SS[[k]]+mat(Y-M,k)%*%t(mat(Y-M,k)) }
}
par(mfrow=c(2,2))
plot(M,SY/s)  ; abline(0,1)
for (k in 1:K) {plot(S[[k]]/tr(S[[k]]),SS[[k]]/tr(SS[[k]])) ; abline(0,1) }
SY<-Y*0
SS<-list() ; for(k in 1:K) { SS[[k]]<-matrix(0,m[k],m[k]) }
for(s in 1:1e4)
{
saidx<-list()
for(k in 1:K){ saidx[[k]]<-sort(sample(1:m[k],1+rbinom(1,m[k]-1,.5))) }
MS<-anorm_cd(Y,M,S,saidx)
Ya<- MS$Mab + atrans(rsan(sapply(saidx,length)),lapply(MS$Sab,mhalf))
Y[arrIndices(saidx)]<-Ya
SY<-SY+Y
for(k in 1:K){SS[[k]]<-SS[[k]]+mat(Y-M,k)%*%t(mat(Y-M,k)) }
}
s
saidx<-list()
for(k in 1:K){ saidx[[k]]<-sort(sample(1:m[k],1+rbinom(1,m[k]-1,.5))) }
MS<-anorm_cd(Y,M,S,saidx)
Ya<- MS$Mab + atrans(rsan(sapply(saidx,length)),lapply(MS$Sab,mhalf))
Y[arrIndices(saidx)]<-Ya
SY<-SY+Y
for(k in 1:K){SS[[k]]<-SS[[k]]+mat(Y-M,k)%*%t(mat(Y-M,k)) }
saidx<-list()
for(k in 1:K){ saidx[[k]]<-sort(sample(1:m[k],1+rbinom(1,m[k]-1,.5))) }
MS<-anorm_cd(Y,M,S,saidx)
Ya<- MS$Mab + atrans(rsan(sapply(saidx,length)),lapply(MS$Sab,mhalf))
Y[arrIndices(saidx)]<-Ya
SY<-SY+Y
for(k in 1:K){SS[[k]]<-SS[[k]]+mat(Y-M,k)%*%t(mat(Y-M,k)) }
saidx<-list()
for(k in 1:K){ saidx[[k]]<-sort(sample(1:m[k],1+rbinom(1,m[k]-1,.5))) }
MS<-anorm_cd(Y,M,S,saidx)
Ya<- MS$Mab + atrans(rsan(sapply(saidx,length)),lapply(MS$Sab,mhalf))
Y[arrIndices(saidx)]<-Ya
SY<-SY+Y
for(k in 1:K){SS[[k]]<-SS[[k]]+mat(Y-M,k)%*%t(mat(Y-M,k)) }
s
SY
dim(SY)
dim(Ya)
saidx<-list()
for(k in 1:K){ saidx[[k]]<-sort(sample(1:m[k],1+rbinom(1,m[k]-1,.5))) }
MS<-anorm_cd(Y,M,S,saidx)
Ya<- MS$Mab + atrans(rsan(sapply(saidx,length)),lapply(MS$Sab,mhalf))
Y[arrIndices(saidx)]<-Ya
SY<-SY+Y
for(k in 1:K){SS[[k]]<-SS[[k]]+mat(Y-M,k)%*%t(mat(Y-M,k)) }
S
saidx
SY<-Y*0
SS<-list() ; for(k in 1:K) { SS[[k]]<-matrix(0,m[k],m[k]) }
for(s in 1:1e4)
{
saidx<-list()
for(k in 1:K){ saidx[[k]]<-sort(sample(1:m[k],1+rbinom(1,m[k]-1,.5))) }
MS<-anorm_cd(Y,M,S,saidx)
Ya<- MS$Mab + atrans(rsan(sapply(saidx,length)),lapply(MS$Sab,mhalf))
Y[arrIndices(saidx)]<-Ya
SY<-SY+Y
for(k in 1:K){SS[[k]]<-SS[[k]]+mat(Y-M,k)%*%t(mat(Y-M,k)) }
}
check()
document()
check()
document()
document()
install()
document()
document()
install()
library(tensr)
?array_cd
?anorm_cd
m<-c(6,5,4)
K<-length(m)
M<-rsan(m)
S<-list() ; for(k in 1:K) { S[[k]]<-rwish(diag(m[k]))/m[k] }
Y<-M+atrans(rsan(m),lapply(S,mhalf))
SY<-Y*0
SS<-list() ; for(k in 1:K) { SS[[k]]<-matrix(0,m[k],m[k]) }
for(s in 1:1e4)
{
saidx<-list()
for(k in 1:K){ saidx[[k]]<-sort(sample(1:m[k],1+rbinom(1,m[k]-1,.5))) }
MS<-anorm_cd(Y,M,S,saidx)
Ya<- MS$Mab + atrans(rsan(sapply(saidx,length)),lapply(MS$Sab,mhalf))
Y[arrIndices(saidx)]<-Ya
SY<-SY+Y
for(k in 1:K){SS[[k]]<-SS[[k]]+mat(Y-M,k)%*%t(mat(Y-M,k)) }
}
par(mfrow=c(2,2))
plot(M,SY/s)  ; abline(0,1)
for (k in 1:K) {plot(S[[k]]/tr(S[[k]]),SS[[k]]/tr(SS[[k]])) ; abline(0,1) }
?multiway_takemura
?multiway_takemura
library(tensr)
install()
?multiway_takemura
document()
library(tensr)
?multiway_takemura
library(devtools)
document()
document()
?equi_mcmc
devtools::load_all(".")
?multiway_takemura
devtools::document()
?multiway_takemura
devtools::document()
?multiway_takemura
# Simulate data.
p <- c(5, 5, 5)
X <- array(rnorm(prod(p)), dim = p)
multi_out <- multiway_takemura(X, mode_rep = 3)
multi_out$b
multi_out$B[[1]]
multi_out$B[[2]]
multi_out$B[[3]]
devtools::document()
?multiway_takemura
# Simulate data.
p <- c(5, 5, 5)
X <- array(rnorm(prod(p)), dim = p)
multi_out <- multiway_takemura(X, mode_rep = 3)
multi_out$b
trim(multi_out$B[[1]])
trim(multi_out$B[[2]])
trim(multi_out$B[[3]])
det(multi_out$B[[1]])
devtools::document()
?multiway_takemura
installed.packages()
install()
devtools::install()
library(tensr)
check()
devtools::check()
?kronecker
devtools::document()
devtools::document()
devtools::install()
devtools::check()
install.packages("bibtex")
install.packages("roclet")
library(devtools)
document()
?convert_cov
document()
?lrt_stat
document()
?hooi
document()
?hooi
document()
install
install()
library(tensr)
?tensr
?demean_tensor
?holq
library(tensr)
?anorm_cd
devtools::document()
devtools::install()
library(tensr)
?anorm_cd
?anorm_cd
?anorm_cd
library(tensr)
?anorm_cd
m<-c(6,5,4)
K<-length(m)
M<-rsan(m)
S<-list() ; for(k in 1:K) { S[[k]]<-rwish(diag(m[k]))/m[k] }
Y<-M+atrans(rsan(m),lapply(S,mhalf))
SY<-Y*0
SS<-list() ; for(k in 1:K) { SS[[k]]<-matrix(0,m[k],m[k]) }
s <- 1
saidx<-list()
for(k in 1:K){ saidx[[k]]<-sort(sample(1:m[k],1+rbinom(1,m[k]-1,.5))) }
saidx
MS<-anorm_cd(Y,M,S,saidx)
ms
MS
saidx
MS
dim(Y)
devtools::document()
package?tensr
devtools::install()
library(tensr)
package?tensr
devtools::build()
devtools::build()
packages?tensr
package?tensr
devtools::document()
package?tensr
?tensr
devtools::build()
?tensr
package?tensr
library(tensr)
package?tensr
devtools::install()
package?tensr
?tsum
?tr
library(tensr)
?tsum
?tensr
?holq
library(tensr)
?hol
?holq
