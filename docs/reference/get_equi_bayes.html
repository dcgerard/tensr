<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Get the Bayes rule under multiway Stein's loss. — get_equi_bayes • tensr</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Get the Bayes rule under multiway Stein's loss. — get_equi_bayes" />

<meta property="og:description" content="Given the output of equi_mcmc, this function will calculate the Bayes
rule under multiway Stein's loss." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tensr</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/equivariant_estimation.html">Equivariant Estimation of Kronecker Structured Covariance Matrices</a>
    </li>
    <li>
      <a href="../articles/maximum_likelihood.html">Likelihood Inference in Kronecker Structured Covariance Models</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Get the Bayes rule under multiway Stein's loss.</h1>
    
    <div class="hidden name"><code>get_equi_bayes.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Given the output of <code>equi_mcmc</code>, this function will calculate the Bayes
rule under multiway Stein's loss.</p>
    
    </div>

    <pre class="usage"><span class='fu'>get_equi_bayes</span>(<span class='no'>psi_inv</span>, <span class='no'>sigma</span>, <span class='kw'>burnin</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>psi_inv</th>
      <td><p>A list of arrays where <code>psi_inv[[i]][[, , j]]</code> is the
\(j\)th update of the <code>i</code>th component. These components are the
inverses of the lower-triangular Cholesky square roots of the component
covariance matrices. You can just use the <code>Phi_inv</code> output from
<code>equi_mcmc</code>.</p></td>
    </tr>
    <tr>
      <th>sigma</th>
      <td><p>A vector of posteior draws of the total variation parameter.
This is just <code>sigma</code> from the output of <code>equi_mcmc</code>.</p></td>
    </tr>
    <tr>
      <th>burnin</th>
      <td><p>A numeric between 0 and 1. What proportion of the posterior
samples do you want to discard as burnin? The default is 0.25.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>Sig_hat</code> A list of the Bayes rules of the component covariance
  matrices under multiway Stein's loss.</p>
<p><code>B</code> A list of the lower-triangular Cholesky square roots of the Bayes
  rules of the component covariance matrices under multiway Stein's loss. We
  have that <code>Sig_hat[[i]]</code> is equal to <code>B[[i]] %*% t(B[[i]])</code>.</p>
<p><code>b</code> A numeric. This is the bayes rule of the total variation
  parameter. This is the 'standard deviation' version. That is, the <code>b ^
  2</code> would be used to calculate the overall covariance matrix.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Multiway Stein's loss is a generalization of Stein's loss to more than two
dimensions. The Bayes rule under this loss is simply represented in terms of
the posterior moments of the component precision matrices. These moments can
be approximated by using the output of <code>equi_mcmc</code>. When using the
invariant prior that is used in <code>equi_mcmc</code>, the resulting Bayes rule is
the uniformly minimum risk equivariant estimator.</p>
<p>More details on multiway Stein's loss and the Bayes rules under it can be
found in
<a href='https://doi.org/10.1016/j.jmva.2015.01.020'>
Gerard and Hoff (2015)</a>.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Gerard, D., &amp; Hoff, P. (2015). Equivariant minimax
    dominators of the MLE in the array normal model.
    <em>Journal of Multivariate Analysis</em>, 137, 32-49.
    <a href='https://doi.org/10.1016/j.jmva.2015.01.020'>https://doi.org/10.1016/j.jmva.2015.01.020</a>
    <a href='http://arxiv.org/pdf/1408.0424.pdf'>http://arxiv.org/pdf/1408.0424.pdf</a></p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='equi_mcmc.html'>equi_mcmc</a></code>.</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>#Generate data whose true covariance is just the identity.</span>
<span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fl'>4</span>,<span class='fl'>4</span>,<span class='fl'>4</span>)
<span class='no'>X</span> <span class='kw'>&lt;-</span> <span class='fu'>array</span>(<span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='fu'>prod</span>(<span class='no'>p</span>)),<span class='kw'>dim</span> <span class='kw'>=</span> <span class='no'>p</span>)
<span class='co'>#Then run the Gibbs sampler.</span>
<span class='no'>mcmc_out</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='equi_mcmc.html'>equi_mcmc</a></span>(<span class='no'>X</span>)
<span class='no'>bayes_rules</span> <span class='kw'>&lt;-</span> <span class='fu'>get_equi_bayes</span>(<span class='no'>mcmc_out</span>$<span class='no'>Phi_inv</span>, <span class='no'>mcmc_out</span>$<span class='no'>sigma</span>)
<span class='no'>bayes_rules</span>$<span class='no'>Sig_hat</span><span class='kw'>[[</span><span class='fl'>1</span>]]</div><div class='output co'>#&gt;             [,1]       [,2]        [,3]      [,4]
#&gt; [1,]  0.93391559 -0.2553807 -0.02042505 0.1394467
#&gt; [2,] -0.25538068  0.7021570  0.13696559 0.1404079
#&gt; [3,] -0.02042505  0.1369656  2.40602917 0.2012246
#&gt; [4,]  0.13944669  0.1404079  0.20122458 0.7950004</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
David Gerard.

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by David Gerard, Peter Hoff.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

