<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculate a truncated multiway Takemura estimator. — multiway_takemura • tensr</title><!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate a truncated multiway Takemura estimator. — multiway_takemura"><meta property="og:description" content="This function will 'average' Bayes rules given random rotations of the data
array. This 'averaged' estimator has lower risk than the uniformly minimum
risk equivariant estimator under a product group of lower triangular
matrices. Truncated multiway Takemura's estimator is not equivariant with
respect to this product group of lower triangular matrices, but it is an
equivariant randomized estimator with respect to a product group of
orthogonal matrices."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tensr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/equivariant_estimation.html">Equivariant Estimation of Kronecker Structured Covariance Matrices</a>
    </li>
    <li>
      <a href="../articles/maximum_likelihood.html">Likelihood Inference in Kronecker Structured Covariance Models</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dcgerard/tensr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate a truncated multiway Takemura estimator.</h1>
    <small class="dont-index">Source: <a href="https://github.com/dcgerard/tensr/blob/HEAD/R/post_equi_mcmc.R" class="external-link"><code>R/post_equi_mcmc.R</code></a></small>
    <div class="hidden name"><code>multiway_takemura.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function will 'average' Bayes rules given random rotations of the data
array. This 'averaged' estimator has lower risk than the uniformly minimum
risk equivariant estimator under a product group of lower triangular
matrices. Truncated multiway Takemura's estimator is not equivariant with
respect to this product group of lower triangular matrices, but it is an
equivariant randomized estimator with respect to a product group of
orthogonal matrices.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">multiway_takemura</span><span class="op">(</span></span>
<span>  <span class="va">X</span>,</span>
<span>  ortho_max <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  mcmc_itermax <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  start_identity <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  print_mcmc <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mode_rep <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An array. This is the data array.</p></dd>


<dt id="arg-ortho-max">ortho_max<a class="anchor" aria-label="anchor" href="#arg-ortho-max"></a></dt>
<dd><p>An integer. The number of 'averagings' to perform.</p></dd>


<dt id="arg-mcmc-itermax">mcmc_itermax<a class="anchor" aria-label="anchor" href="#arg-mcmc-itermax"></a></dt>
<dd><p>An integer. The number of iterations each MCMC should
perform using <code>equi_mcmc</code>.</p></dd>


<dt id="arg-start-identity">start_identity<a class="anchor" aria-label="anchor" href="#arg-start-identity"></a></dt>
<dd><p>Should each MCMC start their covariance matrices at the
identity (TRUE) or at the sample covariance matrices (FALSE)?</p></dd>


<dt id="arg-print-mcmc">print_mcmc<a class="anchor" aria-label="anchor" href="#arg-print-mcmc"></a></dt>
<dd><p>Should the output of the MCMC be printed to the screen
(TRUE) or not (FALSE)?</p></dd>


<dt id="arg-mode-rep">mode_rep<a class="anchor" aria-label="anchor" href="#arg-mode-rep"></a></dt>
<dd><p>A vector of integers. Which mode(s) are considered iid
observations? Default is none.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p><code>B</code> A list of the truncated multiway Takemura's estimators for
  each component covariance matrix. Not their Cholesky square roots.</p>
<p><code>b</code> Truncated multiway Takemura's estimator for the total variation
  parameter. The 'variance' form, not the 'standard devation' form.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function will (1) randomly rotate <code>X</code> along every mode, then (2) it
will calculate the uniformly minimum risk equivariant estimator using
<code>equi_mcmc</code>, then (3) it will 'average' these estimates.</p>
    </div>
    <div id="references">
    <h2>References</h2>

<ul><li><p>Gerard, D., &amp; Hoff, P. (2015). Equivariant minimax dominators of the MLE in the array normal model. <em>Journal of Multivariate Analysis</em>, 137, 32-49. <a href="https://doi.org/10.1016/j.jmva.2015.01.020" class="external-link">doi:10.1016/j.jmva.2015.01.020</a></p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="equi_mcmc.html">equi_mcmc</a></code>, <code><a href="random_ortho.html">random_ortho</a></code>.</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>David Gerard.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Simulate data.</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span>, dim <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">multi_out</span> <span class="op">&lt;-</span> <span class="fu">multiway_takemura</span><span class="op">(</span><span class="va">X</span>, mode_rep <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">multi_out</span><span class="op">$</span><span class="va">b</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9340344</span>
<span class="r-in"><span><span class="fu"><a href="trim.html">trim</a></span><span class="op">(</span><span class="va">multi_out</span><span class="op">$</span><span class="va">B</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]        [,2]       [,3]        [,4]       [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.6911401 -0.43010151 0.11701507  0.41027011 -0.2361179</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.4301015  1.16308672 0.06532907 -0.01621828  0.0238104</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  0.1170151  0.06532907 1.00984274  0.03490203  0.2395732</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.4102701 -0.01621828 0.03490203  0.76661432 -0.2920952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -0.2361179  0.02381040 0.23957315 -0.29209522  1.0395229</span>
<span class="r-in"><span><span class="fu"><a href="trim.html">trim</a></span><span class="op">(</span><span class="va">multi_out</span><span class="op">$</span><span class="va">B</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]        [,2]        [,3]       [,4]       [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.2364194  0.18591914  0.48805777  0.7182665  0.1885822</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.1859191  1.10393856 -0.03767331 -0.3347590 -0.3663760</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.4880578 -0.03767331  1.21073763  0.1520050 -0.2113612</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 0.7182665 -0.33475901  0.15200496  1.4037169  0.4635864</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 0.1885822 -0.36637598 -0.21136120  0.4635864  1.2687095</span>
<span class="r-in"><span><span class="fu"><a href="trim.html">trim</a></span><span class="op">(</span><span class="va">multi_out</span><span class="op">$</span><span class="va">B</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0    1    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    0    0    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]    0    0    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]    0    0    0    0    1</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by David Gerard, Peter Hoff.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

