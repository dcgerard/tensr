<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate a truncated multiway Takemura estimator. — multiway_takemura • tensr</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">tensr</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/equivariant_estimation.html">Equivariant Estimation of Kronecker Structured Covariance Matrices</a>
    </li>
    <li>
      <a href="../articles/maximum_likelihood.html">Likelihood Inference in Kronecker Structured Covariance Models</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://github.com/dcgerard/tensr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate a truncated multiway Takemura estimator.</h1>
    </div>

    
    <p>This function will 'average' Bayes rules given random rotations of the data
array. This 'averaged' estimator has lower risk than the uniformly minimum
risk equivariant estimator under a product group of lower triangular
matrices. Truncated multiway Takemura's estimator is not equivariant with
respect to this product group of lower triangular matrices, but it is an
equivariant randomized estimator with respect to a product group of
orthogonal matrices.</p>
    

    <pre class="usage"><span class='fu'>multiway_takemura</span>(<span class='no'>X</span>, <span class='kw'>ortho_max</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>mcmc_itermax</span> <span class='kw'>=</span> <span class='fl'>1000</span>,
  <span class='kw'>start_identity</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>print_mcmc</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>mode_rep</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>X</th>
      <td><p>An array. This is the data array.</p></td>
    </tr>
    <tr>
      <th>ortho_max</th>
      <td><p>An integer. The number of 'averagings' to perform.</p></td>
    </tr>
    <tr>
      <th>mcmc_itermax</th>
      <td><p>An integer. The number of iterations each MCMC should
perform using <code>equi_mcmc</code>.</p></td>
    </tr>
    <tr>
      <th>start_identity</th>
      <td><p>Should each MCMC start their covariance matrices at the
identity (TRUE) or at the sample covariance matrices (FALSE)?</p></td>
    </tr>
    <tr>
      <th>print_mcmc</th>
      <td><p>Should the output of the MCMC be printed to the screen
(TRUE) or not (FALSE)?</p></td>
    </tr>
    <tr>
      <th>mode_rep</th>
      <td><p>A vector of integers. Which mode(s) are considered iid
observations? Default is none.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>B</code> A list of the truncated multiway Takemura's estimators for
  each component covariance matrix. Not their Cholesky square roots.</p>
<p><code>b</code> Truncated multiway Takemura's estimator for the total variation
  parameter. The 'variance' form, not the 'standard devation' form.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function will (1) randomly rotate <code>X</code> along every mode, then (2) it
will calculate the uniformly minimum risk equivariant estimator using
<code>equi_mcmc</code>, then (3) it will 'average' these estimates.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Gerard, D., &amp; Hoff, P. (2015).
  <a href='http://www.sciencedirect.com/science/article/pii/S0047259X15000330'>Equivariant
  minimax dominators of the MLE in the array normal model</a>. <em>Journal of
  Multivariate Analysis</em>, 137, 32-49.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='equi_mcmc.html'>equi_mcmc</a></code>, <code><a href='random_ortho.html'>random_ortho</a></code>.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Simulate data.</span>
<span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fl'>5</span>, <span class='fl'>5</span>, <span class='fl'>5</span>)
<span class='no'>X</span> <span class='kw'>&lt;-</span> <span class='fu'>array</span>(<span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='fu'>prod</span>(<span class='no'>p</span>)), <span class='kw'>dim</span> <span class='kw'>=</span> <span class='no'>p</span>)
<span class='no'>multi_out</span> <span class='kw'>&lt;-</span> <span class='fu'>multiway_takemura</span>(<span class='no'>X</span>, <span class='kw'>mode_rep</span> <span class='kw'>=</span> <span class='fl'>3</span>)
<span class='no'>multi_out</span>$<span class='no'>b</span></div><div class='output co'>#&gt; [1] 0.8036</div><div class='input'><span class='fu'><a href='trim.html'>trim</a></span>(<span class='no'>multi_out</span>$<span class='no'>B</span><span class='kw'>[[</span><span class='fl'>1</span>]])</div><div class='output co'>#&gt;           [,1]     [,2]    [,3]    [,4]      [,5]
#&gt; [1,]  0.391260 -0.19722  0.2184  0.0735 -0.001292
#&gt; [2,] -0.197217  1.31230 -0.1964 -0.3053 -0.089305
#&gt; [3,]  0.218418 -0.19641  1.6119 -0.2495 -0.342085
#&gt; [4,]  0.073498 -0.30530 -0.2495  1.8078  0.671265
#&gt; [5,] -0.001292 -0.08931 -0.3421  0.6713  1.139266</div><div class='input'><span class='fu'><a href='trim.html'>trim</a></span>(<span class='no'>multi_out</span>$<span class='no'>B</span><span class='kw'>[[</span><span class='fl'>2</span>]])</div><div class='output co'>#&gt;          [,1]     [,2]     [,3]     [,4]     [,5]
#&gt; [1,]  0.83558  0.27839 -0.13689  0.03655 -0.37103
#&gt; [2,]  0.27839  1.00517  0.07682 -0.15349 -0.26208
#&gt; [3,] -0.13689  0.07682  1.22909  0.33125  0.41176
#&gt; [4,]  0.03655 -0.15349  0.33125  1.31450 -0.05019
#&gt; [5,] -0.37103 -0.26208  0.41176 -0.05019  1.26379</div><div class='input'><span class='fu'><a href='trim.html'>trim</a></span>(<span class='no'>multi_out</span>$<span class='no'>B</span><span class='kw'>[[</span><span class='fl'>3</span>]])</div><div class='output co'>#&gt;      [,1] [,2] [,3] [,4] [,5]
#&gt; [1,]    1    0    0    0    0
#&gt; [2,]    0    1    0    0    0
#&gt; [3,]    0    0    1    0    0
#&gt; [4,]    0    0    0    1    0
#&gt; [5,]    0    0    0    0    1</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
David Gerard.

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by David Gerard, Peter Hoff.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
