<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate the incredible higher-order LQ decomposition (HOLQ). — holq • tensr</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">tensr</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/equivariant_estimation.html">Equivariant Estimation of Kronecker Structured Covariance Matrices</a>
    </li>
    <li>
      <a href="../articles/maximum_likelihood.html">Likelihood Inference in Kronecker Structured Covariance Models</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://github.com/dcgerard/tensr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate the incredible higher-order LQ decomposition (HOLQ).</h1>
    </div>

    
    <p>This function calculates a generalization of the LQ decomposition to tensors.
This decomposition has a close connection to likelihood inference in
Kronecker structured covariande models.</p>
    

    <pre class="usage"><span class='fu'>holq</span>(<span class='no'>X</span>, <span class='kw'>tol</span> <span class='kw'>=</span> <span class='fl'>10</span>^-<span class='fl'>9</span>, <span class='kw'>itermax</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='kw'>mode_rep</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>mode_diag</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>mode_ldu</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>print_diff</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>start_vals</span> <span class='kw'>=</span> <span class='st'>"identity"</span>,
  <span class='kw'>use_sig</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>X</th>
      <td><p>An array of numerics.</p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>A numeric. The maximum difference in frobenius norm between two
successive core arrays before stopping. Or maximum difference of the ratio
of sigs from 1 before stopping (which depends on the value of
<code>use_sig</code>).</p></td>
    </tr>
    <tr>
      <th>itermax</th>
      <td><p>An integer. The maximum number of iterations of the LQ
decomposition to do before stopping.</p></td>
    </tr>
    <tr>
      <th>mode_rep</th>
      <td><p>A vector of integers. The optional mode(s) to be considered
identity matrices.</p></td>
    </tr>
    <tr>
      <th>mode_diag</th>
      <td><p>A vector of integers. The optional mode(s) to be considered
as independent but heteroscedastic.</p></td>
    </tr>
    <tr>
      <th>mode_ldu</th>
      <td><p>A vector of integers. The optional modes(s) to be considered
as having unit diagonal.</p></td>
    </tr>
    <tr>
      <th>print_diff</th>
      <td><p>A logical. Should the updates be printed to the screen each
iteration?</p></td>
    </tr>
    <tr>
      <th>start_vals</th>
      <td><p>Determines how to start the optimization algorithm. Either
'identity' (default), or 'residuals', which results in using the cholesky
square roots of the sample covariance matrices along each mode scaled to
have unit determinant. You can also use your own start values.</p></td>
    </tr>
    <tr>
      <th>use_sig</th>
      <td><p>A logical. What stopping criterion should we use? Frobenius
norm of difference of cores (FALSE) or absolute value of difference of
ratio of <code>sig</code> from 1 (TRUE).</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>Z</code> The core array with scaled all-orthonormality property.</p>
<p><code>A</code> A list of matrices.</p>
<p><code>sig</code> A numeric. The total variation parameter. This is the "standard
  deviation" form.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Given an array <code>X</code>, the default version of this function will calculate
(1) <code>L</code> a list of lower triangular matricies with positive diagonal
elements and unit determinant, <code>Z</code> an array of the same dimensions as
<code>X</code> that has special orthogonal properties, and (3) <code>sig</code> a numeric
such that <code>X</code> is the same as <code>sig * atrans(Z,L)</code> up to numeric
precision.</p>
<p>This output (1) can be considered a generalization of the LQ decomposition to
tensors, (2) solves an optimization problem which the matrix LQ decomposition
solves, and (3) has a special connection to likelihood inference in the array
normal model.</p>
<p>There are options to constrain the matrices in <code>L</code> to either be
diagonal, lower triangular with unit diagonal, or the identity matrix. Each
of these correspond to submodels in Kronecker structured covariance models.
The core array corresponding to each of these options has different
properities (see <a href='http://arxiv.org/abs/1410.1094'>Gerard and Hoff
(2014)</a>). These more constrained tensor decompositions are called HOLQ
juniors.</p>
<p>The MLE of the \(i\)th component covariance matrix under <em>any</em>
elliptically contoured Kronecker structured covariance model is given by
<code>L[[i]] %*% t(L[[i]])</code>. The MLE for the total variation pamarameter
will be different depending on the distribution of the array, but for the
array normal it is <code>sig ^ 2 / prod(p)</code> (the "variance" form for the
total variation parameter).</p>
<p>The likelihood ratio test statistic depends only on <code>sig</code> and can be
implemented in <code><a href='lrt_stat.html'>lrt_stat</a></code>.</p>
<p>The algorithm used to fit the HOLQ iteratively repeats the LQ decomposition
along each mode.</p>
<p>For more details on the incredible HOLQ, see
<a href='http://arxiv.org/abs/1410.1094'>Gerard and Hoff (2014)</a>.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Gerard, D. C., &amp; Hoff, P. D. (2014).
  <a href='http://arxiv.org/abs/1410.1094'>A higher-order LQ decomposition for
  separable covariance models</a>. <em>arXiv preprint arXiv:1410.1094.</em></p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='array_bic_aic.html'>array_bic_aic</a></code> for using the output of <code>holq</code> to
  calculate AIC and BIC,</p>
<p><code><a href='get_isvd.html'>get_isvd</a></code> for using the output of <code>holq</code> to calculate a
  tensor generalization of the singular value decomposition.</p>
<p><code><a href='lq.html'>lq</a></code> for the matrix LQ decomposition.</p>
<p><code><a href='lrt_stat.html'>lrt_stat</a></code> for using the output of <code>holq</code> to calculate
  likelihood ratio test statistics.</p>
<p><code><a href='mle_from_holq.html'>mle_from_holq</a></code> for using the output of <code>holq</code> to
  calculate the maximum likelihood estimates of the component covariance
  matrices under the array normal model.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>#Genrate random data.</span>
<span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span>)
<span class='no'>X</span> <span class='kw'>&lt;-</span> <span class='fu'>array</span>(<span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='fu'>prod</span>(<span class='no'>p</span>)), <span class='kw'>dim</span> <span class='kw'>=</span> <span class='no'>p</span>)

<span class='co'>#Calculate HOLQ with unit diagonal on 2nd mode,</span>
<span class='co'>#  and diagonal along 3rd mode.</span>
<span class='no'>holq_x</span> <span class='kw'>&lt;-</span> <span class='fu'>holq</span>(<span class='no'>X</span>, <span class='kw'>mode_ldu</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>mode_diag</span> <span class='kw'>=</span> <span class='fl'>3</span>)</div><div class='output co'>#&gt; Scale Diff =  0.04202 
#&gt;      Scale =  5.149 
#&gt; 
#&gt; Scale Diff =  0.006783 
#&gt;      Scale =  5.114 
#&gt; 
#&gt; Scale Diff =  0.0009639 
#&gt;      Scale =  5.109 
#&gt; 
#&gt; Scale Diff =  0.0002716 
#&gt;      Scale =  5.108 
#&gt; 
#&gt; Scale Diff =  8.427e-05 
#&gt;      Scale =  5.107 
#&gt; 
#&gt; Scale Diff =  2.54e-05 
#&gt;      Scale =  5.107 
#&gt; 
#&gt; Scale Diff =  7.434e-06 
#&gt;      Scale =  5.107 
#&gt; 
#&gt; Scale Diff =  2.143e-06 
#&gt;      Scale =  5.107 
#&gt; 
#&gt; Scale Diff =  6.154e-07 
#&gt;      Scale =  5.107 
#&gt; 
#&gt; Scale Diff =  1.77e-07 
#&gt;      Scale =  5.107 
#&gt; 
#&gt; Scale Diff =  5.112e-08 
#&gt;      Scale =  5.107 
#&gt; 
#&gt; Scale Diff =  1.484e-08 
#&gt;      Scale =  5.107 
#&gt; 
#&gt; Scale Diff =  4.331e-09 
#&gt;      Scale =  5.107 
#&gt; 
#&gt; Scale Diff =  1.269e-09 
#&gt;      Scale =  5.107 
#&gt; 
#&gt; Scale Diff =  3.734e-10 
#&gt;      Scale =  5.107 
#&gt; </div><div class='input'><span class='no'>Z</span> <span class='kw'>&lt;-</span> <span class='no'>holq_x</span>$<span class='no'>Z</span>
<span class='no'>A</span> <span class='kw'>&lt;-</span> <span class='no'>holq_x</span>$<span class='no'>A</span>
<span class='no'>sig</span> <span class='kw'>&lt;-</span> <span class='no'>holq_x</span>$<span class='no'>sig</span>

<span class='co'>#Reconstruct X</span>
<span class='fu'><a href='trim.html'>trim</a></span>(<span class='no'>X</span> - <span class='no'>sig</span> * <span class='fu'><a href='atrans.html'>atrans</a></span>(<span class='no'>Z</span>, <span class='no'>A</span>), <span class='fl'>10</span>^-<span class='fl'>5</span>)</div><div class='output co'>#&gt; , , 1
#&gt; 
#&gt;      [,1] [,2] [,3]
#&gt; [1,]    0    0    0
#&gt; [2,]    0    0    0
#&gt; 
#&gt; , , 2
#&gt; 
#&gt;      [,1] [,2] [,3]
#&gt; [1,]    0    0    0
#&gt; [2,]    0    0    0
#&gt; 
#&gt; , , 3
#&gt; 
#&gt;      [,1] [,2] [,3]
#&gt; [1,]    0    0    0
#&gt; [2,]    0    0    0
#&gt; 
#&gt; , , 4
#&gt; 
#&gt;      [,1] [,2] [,3]
#&gt; [1,]    0    0    0
#&gt; [2,]    0    0    0
#&gt; </div><div class='input'>
<span class='co'>#Properties of core</span>
<span class='co'>#First mode has orthonormal rows.</span>
<span class='fu'><a href='trim.html'>trim</a></span>(<span class='fu'><a href='mat.html'>mat</a></span>(<span class='no'>Z</span>, <span class='fl'>1</span>) <span class='kw'>%*%</span> <span class='fu'>t</span>(<span class='fu'><a href='mat.html'>mat</a></span>(<span class='no'>Z</span>, <span class='fl'>1</span>)), <span class='fl'>10</span>^-<span class='fl'>5</span>)</div><div class='output co'>#&gt;      [,1] [,2]
#&gt; [1,]  0.5  0.0
#&gt; [2,]  0.0  0.5</div><div class='input'>
<span class='co'>#Second mode has orthogonal rows.</span>
<span class='fu'><a href='trim.html'>trim</a></span>(<span class='fu'><a href='mat.html'>mat</a></span>(<span class='no'>Z</span>, <span class='fl'>2</span>) <span class='kw'>%*%</span> <span class='fu'>t</span>(<span class='fu'><a href='mat.html'>mat</a></span>(<span class='no'>Z</span>, <span class='fl'>2</span>)), <span class='fl'>10</span>^-<span class='fl'>5</span>)</div><div class='output co'>#&gt;        [,1]   [,2]   [,3]
#&gt; [1,] 0.3541 0.0000 0.0000
#&gt; [2,] 0.0000 0.2376 0.0000
#&gt; [3,] 0.0000 0.0000 0.4083</div><div class='input'>
<span class='co'>#Third mode has unit diagonal (up to scale).</span>
<span class='fu'>diag</span>(<span class='fu'><a href='mat.html'>mat</a></span>(<span class='no'>Z</span>, <span class='fl'>3</span>) <span class='kw'>%*%</span> <span class='fu'>t</span>(<span class='fu'><a href='mat.html'>mat</a></span>(<span class='no'>Z</span>, <span class='fl'>3</span>)))</div><div class='output co'>#&gt; [1] 0.25 0.25 0.25 0.25</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
David Gerard.

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by David Gerard, Peter Hoff.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
