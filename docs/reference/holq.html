<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculate the incredible higher-order LQ decomposition (HOLQ). — holq • tensr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate the incredible higher-order LQ decomposition (HOLQ). — holq"><meta property="og:description" content="This function calculates a generalization of the LQ decomposition to tensors.
This decomposition has a close connection to likelihood inference in
Kronecker structured covariande models."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tensr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/equivariant_estimation.html">Equivariant Estimation of Kronecker Structured Covariance Matrices</a>
    </li>
    <li>
      <a href="../articles/maximum_likelihood.html">Likelihood Inference in Kronecker Structured Covariance Models</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="http://github.com/dcgerard/tensr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate the incredible higher-order LQ decomposition (HOLQ).</h1>
    <small class="dont-index">Source: <a href="http://github.com/dcgerard/tensr/blob/HEAD/R/tensor_decompositions.R" class="external-link"><code>R/tensor_decompositions.R</code></a></small>
    <div class="hidden name"><code>holq.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function calculates a generalization of the LQ decomposition to tensors.
This decomposition has a close connection to likelihood inference in
Kronecker structured covariande models.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">holq</span><span class="op">(</span></span>
<span>  <span class="va">X</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">9</span>,</span>
<span>  itermax <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  mode_rep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mode_diag <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mode_ldu <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  print_diff <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  start_vals <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  use_sig <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>X</dt>
<dd><p>An array of numerics.</p></dd>


<dt>tol</dt>
<dd><p>A numeric. The maximum difference in frobenius norm between two
successive core arrays before stopping. Or maximum difference of the ratio
of sigs from 1 before stopping (which depends on the value of
<code>use_sig</code>).</p></dd>


<dt>itermax</dt>
<dd><p>An integer. The maximum number of iterations of the LQ
decomposition to do before stopping.</p></dd>


<dt>mode_rep</dt>
<dd><p>A vector of integers. The optional mode(s) to be considered
identity matrices.</p></dd>


<dt>mode_diag</dt>
<dd><p>A vector of integers. The optional mode(s) to be considered
as independent but heteroscedastic.</p></dd>


<dt>mode_ldu</dt>
<dd><p>A vector of integers. The optional modes(s) to be considered
as having unit diagonal.</p></dd>


<dt>print_diff</dt>
<dd><p>A logical. Should the updates be printed to the screen each
iteration?</p></dd>


<dt>start_vals</dt>
<dd><p>Determines how to start the optimization algorithm. Either
'identity' (default), or 'residuals', which results in using the cholesky
square roots of the sample covariance matrices along each mode scaled to
have unit determinant. You can also use your own start values.</p></dd>


<dt>use_sig</dt>
<dd><p>A logical. What stopping criterion should we use? Frobenius
norm of difference of cores (FALSE) or absolute value of difference of
ratio of <code>sig</code> from 1 (TRUE).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p><code>Z</code> The core array with scaled all-orthonormality property.</p>
<p></p>
<p><code>A</code> A list of matrices.</p>
<p></p>
<p><code>sig</code> A numeric. The total variation parameter. This is the "standard
  deviation" form.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Given an array <code>X</code>, the default version of this function will calculate
(1) <code>L</code> a list of lower triangular matricies with positive diagonal
elements and unit determinant, <code>Z</code> an array of the same dimensions as
<code>X</code> that has special orthogonal properties, and (3) <code>sig</code> a numeric
such that <code>X</code> is the same as <code>sig * atrans(Z,L)</code> up to numeric
precision.</p>
<p>This output (1) can be considered a generalization of the LQ decomposition to
tensors, (2) solves an optimization problem which the matrix LQ decomposition
solves, and (3) has a special connection to likelihood inference in the array
normal model.</p>
<p>There are options to constrain the matrices in <code>L</code> to either be
diagonal, lower triangular with unit diagonal, or the identity matrix. Each
of these correspond to submodels in Kronecker structured covariance models.
The core array corresponding to each of these options has different
properities (see <a href="https://doi.org/10.1016/j.laa.2016.04.033" class="external-link">Gerard and Hoff
(2016)</a>). These more constrained tensor decompositions are called HOLQ
juniors.</p>
<p>The MLE of the \(i\)th component covariance matrix under <em>any</em>
elliptically contoured Kronecker structured covariance model is given by
<code>L[[i]] %*% t(L[[i]])</code>. The MLE for the total variation pamarameter
will be different depending on the distribution of the array, but for the
array normal it is <code>sig ^ 2 / prod(p)</code> (the "variance" form for the
total variation parameter).</p>
<p>The likelihood ratio test statistic depends only on <code>sig</code> and can be
implemented in <code><a href="lrt_stat.html">lrt_stat</a></code>.</p>
<p>The algorithm used to fit the HOLQ iteratively repeats the LQ decomposition
along each mode.</p>
<p>For more details on the incredible HOLQ, see
<a href="https://doi.org/10.1016/j.laa.2016.04.033" class="external-link">Gerard and Hoff (2016)</a>.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Gerard, D., &amp; Hoff, P. (2016). A higher-order LQ
    decomposition for separable covariance models.
    <em>Linear Algebra and its Applications</em>, 505, 57-84.
    <a href="https://doi.org/10.1016/j.laa.2016.04.033" class="external-link">https://doi.org/10.1016/j.laa.2016.04.033</a>
    <a href="http://arxiv.org/pdf/1410.1094v1.pdf" class="external-link">http://arxiv.org/pdf/1410.1094v1.pdf</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="array_bic_aic.html">array_bic_aic</a></code> for using the output of <code>holq</code> to
  calculate AIC and BIC,</p>
<p><code><a href="get_isvd.html">get_isvd</a></code> for using the output of <code>holq</code> to calculate a
  tensor generalization of the singular value decomposition.</p>
<p><code><a href="lq.html">lq</a></code> for the matrix LQ decomposition.</p>
<p><code><a href="lrt_stat.html">lrt_stat</a></code> for using the output of <code>holq</code> to calculate
  likelihood ratio test statistics.</p>
<p><code><a href="mle_from_holq.html">mle_from_holq</a></code> for using the output of <code>holq</code> to
  calculate the maximum likelihood estimates of the component covariance
  matrices under the array normal model.</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>David Gerard.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#Genrate random data.</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span>, dim <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Calculate HOLQ with unit diagonal on 2nd mode,</span></span></span>
<span class="r-in"><span><span class="co">#  and diagonal along 3rd mode.</span></span></span>
<span class="r-in"><span><span class="va">holq_x</span> <span class="op">&lt;-</span> <span class="fu">holq</span><span class="op">(</span><span class="va">X</span>, mode_ldu <span class="op">=</span> <span class="fl">2</span>, mode_diag <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scale Diff =  0.04201928 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Scale =  5.148895 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scale Diff =  0.006783263 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Scale =  5.114204 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scale Diff =  0.0009639496 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Scale =  5.109278 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scale Diff =  0.0002716456 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Scale =  5.107891 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scale Diff =  8.426934e-05 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Scale =  5.107461 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scale Diff =  2.539996e-05 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Scale =  5.107331 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scale Diff =  7.434329e-06 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Scale =  5.107293 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scale Diff =  2.143469e-06 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Scale =  5.107282 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scale Diff =  6.1537e-07 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Scale =  5.107279 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scale Diff =  1.769727e-07 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Scale =  5.107278 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scale Diff =  5.111974e-08 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Scale =  5.107278 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scale Diff =  1.484265e-08 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Scale =  5.107277 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scale Diff =  4.331002e-09 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Scale =  5.107277 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scale Diff =  1.269296e-09 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Scale =  5.107277 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scale Diff =  3.73366e-10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Scale =  5.107277 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="va">holq_x</span><span class="op">$</span><span class="va">Z</span></span></span>
<span class="r-in"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="va">holq_x</span><span class="op">$</span><span class="va">A</span></span></span>
<span class="r-in"><span><span class="va">sig</span> <span class="op">&lt;-</span> <span class="va">holq_x</span><span class="op">$</span><span class="va">sig</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Reconstruct X</span></span></span>
<span class="r-in"><span><span class="fu"><a href="trim.html">trim</a></span><span class="op">(</span><span class="va">X</span> <span class="op">-</span> <span class="va">sig</span> <span class="op">*</span> <span class="fu"><a href="atrans.html">atrans</a></span><span class="op">(</span><span class="va">Z</span>, <span class="va">A</span><span class="op">)</span>, <span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Properties of core</span></span></span>
<span class="r-in"><span><span class="co">#First mode has orthonormal rows.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="trim.html">trim</a></span><span class="op">(</span><span class="fu"><a href="mat.html">mat</a></span><span class="op">(</span><span class="va">Z</span>, <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="mat.html">mat</a></span><span class="op">(</span><span class="va">Z</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]      [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.4999998 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.0000000 0.5000002</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Second mode has orthogonal rows.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="trim.html">trim</a></span><span class="op">(</span><span class="fu"><a href="mat.html">mat</a></span><span class="op">(</span><span class="va">Z</span>, <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="mat.html">mat</a></span><span class="op">(</span><span class="va">Z</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>, <span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]      [,2]      [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.3540736 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.0000000 0.2376079 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.0000000 0.0000000 0.4083185</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Third mode has unit diagonal (up to scale).</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="mat.html">mat</a></span><span class="op">(</span><span class="va">Z</span>, <span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="mat.html">mat</a></span><span class="op">(</span><span class="va">Z</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.25 0.25 0.25 0.25</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by David Gerard, Peter Hoff.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

